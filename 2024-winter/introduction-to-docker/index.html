
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="../../contributions/" rel="prev"/>
<link href="../../2023-winter/introduction-to-backend-development-with-django/" rel="next"/>
<link href="../../images/cfc_logo_white_circle.png" rel="icon"/>
<meta content="mkdocs-1.6.0, mkdocs-material-9.5.20" name="generator"/>
<title>Introduction to Docker - Coders for Causes Workshops</title>
<link href="../../assets/stylesheets/main.66ac8b77.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<link href="../../stylesheets/extra.css" rel="stylesheet"/>
<script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="cfclight" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#prerequisites">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Coders for Causes Workshops" class="md-header__button md-logo" data-md-component="logo" href="../.." title="Coders for Causes Workshops">
<img alt="logo" src="../../images/cfc_logo_white_circle.png"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Coders for Causes Workshops
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Introduction to Docker
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="indigo" data-md-color-scheme="cfclight" id="__palette_0" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"></path></svg>
</label>
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="indigo" data-md-color-scheme="slate" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"></path></svg>
</label>
</form>
<script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/codersforcauses/workshops/" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../..">
          
  
  About

        </a>
</li>
<li class="md-tabs__item md-tabs__item--active">
<a class="md-tabs__link" href="./">
          
  
  2024 Winter

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../2023-winter/introduction-to-backend-development-with-django/">
          
  
  2023 Winter

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../2022-2023-summer/">
          
  
  2022/2023 Summer

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../2021-2022-summer/">
          
  
  2021/2022 Summer

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../2021-winter/">
          
  
  2021 Winter

        </a>
</li>
</ul>
</div>
</nav>
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Coders for Causes Workshops" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="Coders for Causes Workshops">
<img alt="logo" src="../../images/cfc_logo_white_circle.png"/>
</a>
    Coders for Causes Workshops
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/codersforcauses/workshops/" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
<span class="md-ellipsis">
    About
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_1_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_1">
<span class="md-nav__icon md-icon"></span>
            About
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../..">
<span class="md-ellipsis">
    Overview
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../contributions/">
<span class="md-ellipsis">
    Contributions
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
<span class="md-ellipsis">
    2024 Winter
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
            2024 Winter
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    Introduction to Docker
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    Introduction to Docker
  </span>
</a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#prerequisites">
<span class="md-ellipsis">
      Prerequisites
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#what-you-will-be-building-as-part-of-this-workshop">
<span class="md-ellipsis">
      What you will be building as part of this workshop?
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#important-information">
<span class="md-ellipsis">
      Important information
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#what-is-docker">
<span class="md-ellipsis">
      What is Docker?
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#getting-started">
<span class="md-ellipsis">
      Getting started
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#what-does-the-app-do">
<span class="md-ellipsis">
      What does the app do?
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#what-do-we-need-to-do">
<span class="md-ellipsis">
      What do we need to do?
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#building-and-running-an-image">
<span class="md-ellipsis">
      Building and running an image
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#manual-build">
<span class="md-ellipsis">
      Manual build
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#creating-a-dockerfile">
<span class="md-ellipsis">
      Creating a Dockerfile
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#optimising-the-dockerfile">
<span class="md-ellipsis">
      Optimising the Dockerfile
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#final-touches">
<span class="md-ellipsis">
      Final touches
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#conclusion">
<span class="md-ellipsis">
      Conclusion
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
<span class="md-ellipsis">
    2023 Winter
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
            2023 Winter
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../2023-winter/introduction-to-backend-development-with-django/">
<span class="md-ellipsis">
    Introduction to Backend Development With Django
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
<span class="md-ellipsis">
    2022/2023 Summer
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
            2022/2023 Summer
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../2022-2023-summer/">
<span class="md-ellipsis">
    Overview
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../2022-2023-summer/setup.md">
<span class="md-ellipsis">
    Setup
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../2022-2023-summer/introduction-to-web-development/">
<span class="md-ellipsis">
    Introduction to Web Development
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../2022-2023-summer/practical-software-engineering-workflow/">
<span class="md-ellipsis">
    Practical Software Engineering Workflow
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../2022-2023-summer/mvc-mvvm-architecture-and-communications/">
<span class="md-ellipsis">
    MVC and MVVM Software Architectural Patterns and Communications
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
<span class="md-ellipsis">
    2021/2022 Summer
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
            2021/2022 Summer
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../2021-2022-summer/">
<span class="md-ellipsis">
    Overview
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../2021-2022-summer/setup/">
<span class="md-ellipsis">
    Setup
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../2021-2022-summer/project-and-workshop-structure/">
<span class="md-ellipsis">
    Project and Workshop Structure
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../2021-2022-summer/introduction-to-web-development/">
<span class="md-ellipsis">
    Introduction to Web Development
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../2021-2022-summer/introduction-web-basics/">
<span class="md-ellipsis">
    Introduction to Web Basics
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../2021-2022-summer/practical-software-engineering-practices/">
<span class="md-ellipsis">
    Practical Software Engineering Practices
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_5_7" id="__nav_5_7_label" tabindex="0">
<span class="md-ellipsis">
    Introduction to Frontend Frameworks
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_7_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_7">
<span class="md-nav__icon md-icon"></span>
            Introduction to Frontend Frameworks
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../2021-2022-summer/introduction-to-frontend-frameworks/">
<span class="md-ellipsis">
    Overview
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../2021-2022-summer/introduction-to-react/">
<span class="md-ellipsis">
    Introduction to React
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../2021-2022-summer/introduction-to-vue/">
<span class="md-ellipsis">
    Introduction to Vue
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../2021-2022-summer/introduction-to-backend-development-with-django/">
<span class="md-ellipsis">
    Introduction to Backend Development with Django
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../2021-2022-summer/mvc-mvmm-architecture-and-communications/">
<span class="md-ellipsis">
    MVC-MVMM Architecture and Communications
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../2021-2022-summer/package-managers/">
<span class="md-ellipsis">
    Package Managers
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../2021-2022-summer/typical-codebase-structure/">
<span class="md-ellipsis">
    Typical Codebase Structure
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../2021-2022-summer/automated-testing-and-ci-pipelines/">
<span class="md-ellipsis">
    Automated Testing and CI Pipelines
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
<span class="md-ellipsis">
    2021 Winter
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_6_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_6">
<span class="md-nav__icon md-icon"></span>
            2021 Winter
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../2021-winter/">
<span class="md-ellipsis">
    Overview
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1>Introduction to Docker</h1>
<h2 id="prerequisites">Prerequisites<a class="headerlink" href="#prerequisites" title="Permanent link">¶</a></h2>
<p>You need the following installed:</p>
<ul>
<li><a href="https://git-scm.com/downloads">Git</a></li>
<li><a href="https://nodejs.org/en/download">Node.js</a></li>
<li><a href="https://www.docker.com/get-started/">Docker</a></li>
<li><a href="https://code.visualstudio.com/download">VSCode</a> (highly recommended)</li>
</ul>
<p>The starting repo for this workshop: <a href="https://github.com/codersforcauses/docker-workshop">https://github.com/codersforcauses/docker-workshop</a></p>
<h2 id="what-you-will-be-building-as-part-of-this-workshop">What you will be building as part of this workshop?<a class="headerlink" href="#what-you-will-be-building-as-part-of-this-workshop" title="Permanent link">¶</a></h2>
<p>CFC wants to make an app for accepting coffee orders. You will be creating a Dockerfile for CFC's (totally real) new and upcoming rebrand: <em>Coders for Coffee 🐳</em>. The architecture is a simple frontend and backend both made in TypeScript. Below is a diagram of it:</p>
<p><img alt="App Architecture" src="../images/app-architecture.png"/></p>
<h2 id="important-information">Important information<a class="headerlink" href="#important-information" title="Permanent link">¶</a></h2>
<p>This workshop relies on a certain understanding of terminal commands and a bit of familiarity with Node.js projects. If you're not familiar with these, don't worry! I'll be explaining everything as we go along. If you have any questions, feel free to ask.</p>
<h2 id="what-is-docker">What is Docker?<a class="headerlink" href="#what-is-docker" title="Permanent link">¶</a></h2>
<p>Docker is a platform for developing, shipping, and running applications using containerization. It allows you to package an application and its dependencies into a container that can run on any machine. This makes it easy to deploy applications in a consistent and reproducible way. Simply put, it's like a way of running mini virtual machines inside your computer.</p>
<h3 id="why-use-docker">Why use Docker?<a class="headerlink" href="#why-use-docker" title="Permanent link">¶</a></h3>
<ul>
<li><strong>Consistency</strong>: Docker containers are isolated from the host system and other containers, ensuring that the application runs the same way everywhere.</li>
<li><strong>Portability</strong>: Containers can be run on any machine that has Docker installed, making it easy to move applications between environments.</li>
<li><strong>Efficiency</strong>: Containers are lightweight and share the host system's resources, making them more efficient than virtual machines.</li>
<li><strong>Scalability</strong>: Docker makes it easy to scale applications by running multiple containers on the same host or across multiple hosts.</li>
<li><strong>Security</strong>: Containers are isolated from each other and the host system, providing an additional layer of security.</li>
<li><strong>DevOps</strong>: Docker is a key tool in the DevOps toolchain, enabling developers to build, test, and deploy applications more easily. Imagine a software job where instead of writing software for end-users, you write software to make developers' lives easier!</li>
</ul>
<h3 id="definitions">Definitions<a class="headerlink" href="#definitions" title="Permanent link">¶</a></h3>
<ul>
<li><strong>Dockerfile 📜</strong>: A text file that contains instructions for building a Docker <strong>image</strong>. It specifies the base image, dependencies, environment variables, and commands to run when the container starts. Think like a recipe for baking a cake.</li>
<li><strong>Image 📀</strong>: A read-only template with instructions for creating a Docker <strong>container</strong>. It contains the application code, runtime, libraries, environment variables, and configuration files. Think like a CD with music on it.</li>
<li><strong>Container ▶️</strong>: An instance of an image that can be run as a process on the host machine. It is isolated from other containers and the host system. Think like a CD in a CD player.</li>
</ul>
<h3 id="how-do-i-use-docker">How do I use Docker?<a class="headerlink" href="#how-do-i-use-docker" title="Permanent link">¶</a></h3>
<p>This is a high-level overview of how Docker works:</p>
<p><img alt="Docker Architecture" src="../images/docker-diagram.png"/></p>
<p>In action, you'll only need to know a few commands to get started:</p>
<ol>
<li><code>docker pull</code>: Pull an <strong>image</strong> from a <strong>registry</strong> (like Docker Hub).</li>
<li><code>docker run &lt;image&gt;</code>: Run a <strong>container</strong> from an <strong>image</strong>.</li>
<li><code>docker build</code>: Build a <strong>Dockerfile</strong> into an <strong>image</strong>.</li>
</ol>
<h2 id="getting-started">Getting started<a class="headerlink" href="#getting-started" title="Permanent link">¶</a></h2>
<p>Firstly, open your IDE and open the terminal.</p>
<ol>
<li>Clone the repository: <code>git clone https://github.com/codersforcauses/docker-workshop.git</code></li>
<li>Go to the directory: <code>cd docker-workshop</code></li>
<li>Run the setup script: <code>npm run setup</code></li>
<li>Run the app: <code>npm run dev</code>. Visit <a href="http://localhost:3000">http://localhost:3000</a> to see it in action.</li>
</ol>
<details class="info">
<summary>What does the setup script do?</summary>
<p>The setup script installs the dependencies for both the frontend and backend. It is located in the <code>package.json</code> in the root. Formatted nicely:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code>npm<span class="w"> </span>install<span class="w"> </span>--prefix<span class="w"> </span>apps/frontend<span class="w"> </span>-g<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="c1"># install dependencies for the frontend</span>
npm<span class="w"> </span>install<span class="w"> </span>--prefix<span class="w"> </span>apps/backend<span class="w"> </span>-g<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="c1"># install dependencies for the backend</span>
npm<span class="w"> </span>install<span class="w"> </span><span class="c1"># install dependencies for the root (just a little handy package to run both apps with one command)</span>
</code></pre></div></td></tr></table></div>
</details>
<h2 id="what-does-the-app-do">What does the app do?<a class="headerlink" href="#what-does-the-app-do" title="Permanent link">¶</a></h2>
<p>The frontend is a simple form that takes a user's order and sends it to the backend. The backend then saves the order to a "database". Below is a screenshot of the app:</p>
<p><img alt="Application" src="../images/app-frontend.png"/></p>
<h3 id="frontend">Frontend<a class="headerlink" href="#frontend" title="Permanent link">¶</a></h3>
<p>The frontend is a single page app that takes orders. It runs at <a href="http://localhost:3000">http://localhost:3000</a>.</p>
<details class="info">
<summary>Where is the frontend code?</summary>
<p>The frontend code is located in the <code>apps/frontend</code> directory. The main file is <code>src/App.tsx</code>.</p>
</details>
<h3 id="backend">Backend<a class="headerlink" href="#backend" title="Permanent link">¶</a></h3>
<p>The backend is a simple Hono http server that listens for certain requests. It runs at <a href="http://localhost:3001">http://localhost:3001</a>. There are 3 important endpoints:</p>
<ol>
<li><code>GET /</code> - Show a simple page to check if the server is running</li>
<li><code>GET /orders</code> - Get all orders</li>
<li><code>POST /orders</code> - Create an order</li>
</ol>
<details class="info">
<summary>Where is the backend code?</summary>
<p>The backend code is located in the <code>apps/backend</code> directory. The main file is <code>src/index.ts</code>.</p>
</details>
<p>You can view the first two by going to <a href="http://localhost:3001">http://localhost:3001</a> and <a href="http://localhost:3001/orders">http://localhost:3001/orders</a> in your browser.</p>
<h2 id="what-do-we-need-to-do">What do we need to do?<a class="headerlink" href="#what-do-we-need-to-do" title="Permanent link">¶</a></h2>
<p>We need to create a <strong>Dockerfile</strong> to <strong>build</strong> the frontend and backend to <strong>images</strong>, then run them as <strong>containers</strong>. I have already created a Dockerfile for the backend, which is located in the <code>apps/backend</code> directory. You will need to create a Dockerfile for the frontend.</p>
<details class="info">
<summary>Can I cheat?</summary>
<p>Yes... If you choose to look at it, you might find it helpful. However, it comes with a few optimisations which may be confusing.</p>
</details>
<h2 id="building-and-running-an-image">Building and running an image<a class="headerlink" href="#building-and-running-an-image" title="Permanent link">¶</a></h2>
<p>Close the app dev server we ran earlier with <code>CTRL+C</code>.</p>
<p>Let's start by learning how to build and run a Docker image. First, let's build the backend:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>docker-workshop-backend<span class="w"> </span>./apps/backend
</code></pre></div></td></tr></table></div>
<p>This command builds an image from the Dockerfile in the <code>apps/backend</code> directory and tags it (<code>-t</code>) with the name <code>docker-workshop-backend</code>. Otherwise, Docker will give it a random name.</p>
<p>Now, let's run the image we've built:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-p<span class="w"> </span><span class="m">3001</span>:3001<span class="w"> </span>docker-workshop-backend
</code></pre></div></td></tr></table></div>
<div class="admonition warning">
<p class="admonition-title">Port Mapping</p>
<p>But wait, what does <code>-p 3001:3001</code> do? I mentioned earlier that Docker basically runs mini virtual machines --- so let's visualise what that looks like.</p>
<p><img alt="Docker Port Mapping" src="../images/docker-port-mapping.png"/></p>
<p>In order for our container to make connect with the outside world, we need to create a little tunnel. This is done by mapping a port on the host machine to a port on the container. In our case, I've configured the backend to run internally on port <code>3001</code>. Therefore, we need to map that internal port to a port on the host machine so we can access it. I kept it simple and mapped it to the same port, but you can change it to any port you like (given our frontend knows about it). Ports are mapped like this: <code>-p &lt;host-port&gt;:&lt;container-port&gt;</code> This also improves security, as you can run multiple containers on the same host machine without them interfering with each other.</p>
</div>
<p>Now, visit <a href="http://localhost:3001">http://localhost:3001</a> to see the backend now running from a Docker container.</p>
<h2 id="manual-build">Manual build<a class="headerlink" href="#manual-build" title="Permanent link">¶</a></h2>
<p>To get a better idea of what we need to do, let's build the frontend manually.</p>
<h3 id="step-1-what-are-we-building">Step 1: What are we building?<a class="headerlink" href="#step-1-what-are-we-building" title="Permanent link">¶</a></h3>
<p>Imagine you are a robot that will execute commands to build the app to be production-ready. Regardless of what you're making, it'll usually fall into this pattern:</p>
<ol>
<li>Install dependencies</li>
<li>Build the app (if needed)</li>
<li>Serve or run the build files</li>
</ol>
<h3 id="step-2-mapping-them-to-commands">Step 2: Mapping them to commands<a class="headerlink" href="#step-2-mapping-them-to-commands" title="Permanent link">¶</a></h3>
<p>The frontend is a React app that uses TypeScript, so we'll follow the template. If you're unsure, you can always Google what you need e.g. "How to install dependenceis React app":</p>
<ol>
<li>In your terminal, navigate to the frontend directory: <code>cd apps/frontend</code></li>
<li>Install dependencies: <code>npm install</code></li>
<li>Build the app: <code>npm run build</code></li>
<li>Serve the build files: <code>npm run start</code></li>
</ol>
<p>The <code>build</code> and <code>start</code> scripts are located in <code>apps/frontend/package.json</code>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="w">    </span><span class="nt">"scripts"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">"build"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tsc &amp;&amp; vite build"</span><span class="p">,</span>
<span class="w">        </span><span class="nt">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"serve dist -p 9876"</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>You can run these commands in the terminal yourself and open it up at <a href="http://localhost:9876/">http://localhost:9876/</a> to see the optimised production build of the frontend. Notice how the bottom text has changed from "development" to "production".</p>
<h2 id="creating-a-dockerfile">Creating a Dockerfile<a class="headerlink" href="#creating-a-dockerfile" title="Permanent link">¶</a></h2>
<p>When creating a Dockerfile, it's essentially the same process as manually doing it. The only difference is that you're automating it in a file.</p>
<h3 id="base-image">Base image<a class="headerlink" href="#base-image" title="Permanent link">¶</a></h3>
<p>All Dockerfiles start with a <code>FROM</code> command, which specifies the base image to use. This image is usually a lightweight Linux distribution with the necessary tools and libraries to run the application. For our frontend, we will use the <a href="https://hub.docker.com/_/node"><code>node:20-alpine</code></a> image. This specifies the (as of writing) LTS version of Node.js with the Alpine Linux distribution.</p>
<details class="info" open="open">
<summary>How do I know what image to use?</summary>
<p>There are a number of things to consider when choosing a base image:</p>
<ul>
<li><strong>Application</strong>: Because we're running a Node.js app, an image with Node.js already installed is a good choice.</li>
<li><strong>Size</strong>: Smaller images are faster to download and use less disk space.</li>
<li><strong>Security</strong>: Official images are more secure and are regularly updated. Most of the time you'll be using images from Docker Hub.</li>
<li><strong>Compatibility</strong>: Make sure the image is compatible with your application. In this case, the current LTS release for Node.js is 20, so we will use <code>node:20-alpine</code>. Locking the version down is also good practice to prevent images from suddenly breaking.</li>
</ul>
</details>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c"># Use the official Node.js image as the base image</span>
<span class="k">FROM</span><span class="w"> </span><span class="s">node:20-alpine</span>
</code></pre></div></td></tr></table></div>
<h3 id="working-directory">Working directory<a class="headerlink" href="#working-directory" title="Permanent link">¶</a></h3>
<p>We're in linux land now. First, let's create a directory to put our production files in. This is done with the <code>WORKDIR</code> command.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">FROM</span><span class="w"> </span><span class="s">node:20-alpine</span>

<span class="c"># Set the working directory in the container</span>
<span class="k">WORKDIR</span><span class="w"> </span><span class="s">/app</span>
</code></pre></div></td></tr></table></div>
<details class="info">
<summary>Why do we need a working directory?</summary>
<p>The <code>WORKDIR</code> command sets the working directory for any subsequent commands in the Dockerfile. This is where the application code will be copied to and where the application will run from. It's like changing directories in the terminal. Just like your own computer, you don't want to group important system files with your projects. It can be named anything you like, but the general convention is to name it <code>/app</code>.</p>
</details>
<h3 id="copying-files">Copying files<a class="headerlink" href="#copying-files" title="Permanent link">¶</a></h3>
<p>Next, we need to copy our source code into the image. This is done with the <code>COPY</code> command.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c"># Use the official Node.js image as the base image</span>
<span class="k">FROM</span><span class="w"> </span><span class="s">node:20-alpine</span>
<span class="k">WORKDIR</span><span class="w"> </span><span class="s">/app</span>

<span class="c"># Copy the important files to the working directory</span>
<span class="k">COPY</span><span class="w"> </span>.<span class="w"> </span>./
</code></pre></div></td></tr></table></div>
<details class="info" open="open">
<summary>What are we copying?</summary>
<p>This command copies everything in the same directory where the Dockerfile is (<code>.</code>) from the host machine to the working directory in the container (<code>./</code>). This is the bare minimum we need to build the frontend. i.e. src, public, package.json, etc.</p>
</details>
<h3 id="installing-dependencies-and-building">Installing dependencies and building<a class="headerlink" href="#installing-dependencies-and-building" title="Permanent link">¶</a></h3>
<p>Now that we have our source code in the image, we need to install the dependencies. This is done with the <code>RUN</code> command. You can execute any supported command from the base image specified. Here, we run both <code>npm install</code> and <code>npm run build</code> in succession using <code>&amp;&amp;</code>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">FROM</span><span class="w"> </span><span class="s">node:20-alpine</span>

<span class="k">WORKDIR</span><span class="w"> </span><span class="s">/app</span>
<span class="k">COPY</span><span class="w"> </span>.<span class="w"> </span>./

<span class="c"># Install dependencies and build the app</span>
<span class="k">RUN</span><span class="w"> </span>npm<span class="w"> </span>install<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>npm<span class="w"> </span>run<span class="w"> </span>build
</code></pre></div></td></tr></table></div>
<details class="info" open="open">
<summary>Why not do it on separate lines?</summary>
<p>The reason we chain install <code>&amp;&amp;</code> build is to reduce the number of layers in the image. Each <code>RUN</code> command creates a new layer in the image, which is essentially a snapshot of everything you've <code>RUN</code> up until now. More layers means a larger image size. By chaining commands together, we can reduce the number of layers and make the image smaller. Docker uses this to cache layers, so if you change a file, it will only rebuild the layers that depend on that file, saving time. In our case, our two commands both depend on the same files, so we should group them together.</p>
</details>
<h3 id="serving-the-build">Serving the build<a class="headerlink" href="#serving-the-build" title="Permanent link">¶</a></h3>
<p>We're almost there! The last thing we need to do is serve the build files. This is done with the <code>CMD</code> command. This command specifies the command to run when the container starts. In our case, we want to run <code>npm run start</code>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">FROM</span><span class="w"> </span><span class="s">node:20-alpine</span>
<span class="k">WORKDIR</span><span class="w"> </span><span class="s">/app</span>

<span class="k">COPY</span><span class="w"> </span>.<span class="w"> </span>./

<span class="k">RUN</span><span class="w"> </span>npm<span class="w"> </span>install<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>npm<span class="w"> </span>run<span class="w"> </span>build

<span class="c"># Serve the build files, note how it's an array</span>
<span class="k">CMD</span><span class="w"> </span><span class="p">[</span><span class="s2">"npm"</span><span class="p">,</span><span class="w"> </span><span class="s2">"run"</span><span class="p">,</span><span class="w"> </span><span class="s2">"start"</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
<p>We're done --- not. There's one last thing we need to do: specify the port the server will run on. This is done with the <code>EXPOSE</code> command. Notice how earlier, <code>npm run start</code> actually started the server on port <code>9876</code>, so let's expose that instead.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">FROM</span><span class="w"> </span><span class="s">node:20-alpine</span>
<span class="k">WORKDIR</span><span class="w"> </span><span class="s">/app</span>

<span class="k">COPY</span><span class="w"> </span>.<span class="w"> </span>./

<span class="k">RUN</span><span class="w"> </span>npm<span class="w"> </span>install<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>npm<span class="w"> </span>run<span class="w"> </span>build

<span class="c"># Serve the build files</span>
<span class="k">EXPOSE</span><span class="w"> </span><span class="s">9876</span>
<span class="k">CMD</span><span class="w"> </span><span class="p">[</span><span class="s2">"npm"</span><span class="p">,</span><span class="w"> </span><span class="s2">"run"</span><span class="p">,</span><span class="w"> </span><span class="s2">"start"</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
<h3 id="done">Done<a class="headerlink" href="#done" title="Permanent link">¶</a></h3>
<p>You can now build and run the frontend image. We can actually specify a specific port in the <code>CMD</code>, but I'm just going to map it to port <code>3000</code> on the host machine when running the container.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code>docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>docker-workshop-frontend<span class="w"> </span>./apps/frontend
docker<span class="w"> </span>run<span class="w"> </span>-p<span class="w"> </span><span class="m">3000</span>:9876<span class="w"> </span>docker-workshop-frontend
</code></pre></div></td></tr></table></div>
<p>If we open up Docker desktop, you can even inspect the container's filesystem to see what we've done.</p>
<p><img alt="Docker Desktop" src="../images/docker-desktop.png"/></p>
<p>The frontend is now running at <a href="http://localhost:3000">http://localhost:3000</a>!</p>
<h2 id="optimising-the-dockerfile">Optimising the Dockerfile<a class="headerlink" href="#optimising-the-dockerfile" title="Permanent link">¶</a></h2>
<p>Let's think about what we've done. We've copied the source code, installed dependencies, built the app, and served the build files. But there are a few things we can do to optimise the Dockerfile:</p>
<ul>
<li><strong>Only have production dependencies in the image.</strong> Sometimes we developers install dev dependencies that aren't needed in production, but make our lives easier. If you take a look at <code>apps/frontend/package.json</code>, you'll see a bunch of them.</li>
<li><strong>Don't have the source code in the image.</strong> We only need the built files to run the app. This reduces the image size.</li>
</ul>
<h3 id="prune-the-dependencies">Prune the dependencies<a class="headerlink" href="#prune-the-dependencies" title="Permanent link">¶</a></h3>
<p>This is the easiest one. For a node app, you can do <code>npm prune --production</code> to remove all dev dependencies.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">FROM</span><span class="w"> </span><span class="s">node:20-alpine</span>
<span class="k">WORKDIR</span><span class="w"> </span><span class="s">/app</span>

<span class="k">COPY</span><span class="w"> </span>.<span class="w"> </span>./

<span class="c"># Cleanup in the same layer</span>
<span class="k">RUN</span><span class="w"> </span>npm<span class="w"> </span>install<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>npm<span class="w"> </span>run<span class="w"> </span>build<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>npm<span class="w"> </span>prune<span class="w"> </span>--production

<span class="c"># Serve the build files</span>
<span class="k">EXPOSE</span><span class="w"> </span><span class="s">9876</span>
<span class="k">CMD</span><span class="w"> </span><span class="p">[</span><span class="s2">"npm"</span><span class="p">,</span><span class="w"> </span><span class="s2">"run"</span><span class="p">,</span><span class="w"> </span><span class="s2">"start"</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
<h3 id="multi-stage-builds">Multi-Stage builds<a class="headerlink" href="#multi-stage-builds" title="Permanent link">¶</a></h3>
<p>Now we want to remove the source code from the image. You might think you could build the app outside the image, but that would mean you'd need to have Node.js installed on your machine, which defeats the purpose of containerisation. Additionally, some dependencies are platform-specific, so the app might not even work when put inside the container. This is where multi-stage builds come in.</p>
<p>A multi-stage build is a feature of Docker that allows you to use multiple <code>FROM</code> commands in a single Dockerfile. Each <code>FROM</code> command starts a new stage in the build process. You can copy files from one stage to another, allowing you to build the app in one stage and copy the built files to another stage.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c"># Stage 0: Define a common image for building and running</span>
<span class="k">FROM</span><span class="w"> </span><span class="s">node:20-alpine</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="s">base</span>


<span class="c"># Stage 1: Build the app</span>
<span class="k">FROM</span><span class="w"> </span><span class="s">base</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="s">builder</span>
<span class="k">WORKDIR</span><span class="w"> </span><span class="s">/app</span>

<span class="k">COPY</span><span class="w"> </span>.<span class="w"> </span>./

<span class="k">RUN</span><span class="w"> </span>npm<span class="w"> </span>install<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>npm<span class="w"> </span>run<span class="w"> </span>build<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>npm<span class="w"> </span>prune<span class="w"> </span>--production

<span class="c"># Stage 2: Serve the build files</span>
<span class="k">FROM</span><span class="w"> </span><span class="s">base</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="s">runner</span>
<span class="k">WORKDIR</span><span class="w"> </span><span class="s">/app</span>

<span class="c"># Copy dependencies</span>
<span class="k">COPY</span><span class="w"> </span>--from<span class="o">=</span>builder<span class="w"> </span>/app/node_modules<span class="w"> </span>./node_modules
<span class="c"># Copy built files</span>
<span class="k">COPY</span><span class="w"> </span>--from<span class="o">=</span>builder<span class="w"> </span>/app/dist<span class="w"> </span>./dist
<span class="c"># Copy package.json so we can run `npm run start`</span>
<span class="k">COPY</span><span class="w"> </span>--from<span class="o">=</span>builder<span class="w"> </span>/app/package.json<span class="w"> </span>./package.json

<span class="k">EXPOSE</span><span class="w"> </span><span class="s">9876</span>
<span class="k">CMD</span><span class="w"> </span><span class="p">[</span><span class="s2">"npm"</span><span class="p">,</span><span class="w"> </span><span class="s2">"run"</span><span class="p">,</span><span class="w"> </span><span class="s2">"start"</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
<h2 id="final-touches">Final touches<a class="headerlink" href="#final-touches" title="Permanent link">¶</a></h2>
<p>So now we know how to build a Dockerfile into an image and run it as a container. But there is one more thing we can do to make our lives easier: <strong>Docker Compose</strong>.</p>
<p>Docker Compose is a tool for defining and running multi-container Docker applications. It allows you to define the services, networks, and volumes for your application in a single file. This makes it easy to start, stop, and manage your application with a single command.</p>
<p>I've already created a <code>docker-compose.yml</code> file for you. It defines two services: <code>frontend</code> and <code>backend</code>. Instead of doing <code>docker run ...</code> in two terminals, you can now can run both services with a single command. You don't even have to build the images, as Docker Compose will do that for you!</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>up
</code></pre></div></td></tr></table></div>
<p>You also might find the frontend starting on port <code>9876</code> inside the container to be a little confusing. You can change the port mapping in the <code>docker-compose.yml</code> file to map it to port <code>3000</code> on the host machine. Don't forget to change the <code>package.json</code> script and the <code>EXPOSE</code> command in the Dockerfile as well.</p>
<h2 id="conclusion">Conclusion<a class="headerlink" href="#conclusion" title="Permanent link">¶</a></h2>
<p>This is just a small taste of what Docker can do. You could put your entire dev environment inside, push images to a registry and run them in the cloud, or even run a bunch of them in a Kubernetes cluster. Keep in mind that we only built a Dockerfile for a simple React app, so it'll be a different depending on what you do. Luckily, there are countless resources online to help you out --- just google "how to dockerise a <insert here="" stack="" tech="" your=""> app".</insert></p>
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
</main>
<footer class="md-footer">
<nav aria-label="footer.title" class="md-footer__inner md-grid">
<a class="md-footer__link md-footer__link--prev" href="../../contributions/" rel="prev">
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</div>
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                  Previous
                </span>
                Contributions
              </div>
</div>
</a>
<a class="md-footer__link md-footer__link--next" href="../../2023-winter/introduction-to-backend-development-with-django/" rel="next">
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                  Next
                </span>
                Introduction to Backend Development With Django
              </div>
</div>
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"></path></svg>
</div>
</a>
</nav>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
          
          Web Documentation Setup By
          <a href="https://codersforcauses.org/" rel="noopener" target="_blank">
            Coders for Causes
          </a>
</div>
<div class="md-social">
<a class="md-social__link" href="https://codersforcauses.org/" rel="noopener" target="_blank" title="codersforcauses.org">
<svg viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0ZM5.78 8.75a9.64 9.64 0 0 0 1.363 4.177c.255.426.542.832.857 1.215.245-.296.551-.705.857-1.215A9.64 9.64 0 0 0 10.22 8.75Zm4.44-1.5a9.64 9.64 0 0 0-1.363-4.177c-.307-.51-.612-.919-.857-1.215a9.927 9.927 0 0 0-.857 1.215A9.64 9.64 0 0 0 5.78 7.25Zm-5.944 1.5H1.543a6.507 6.507 0 0 0 4.666 5.5c-.123-.181-.24-.365-.352-.552-.715-1.192-1.437-2.874-1.581-4.948Zm-2.733-1.5h2.733c.144-2.074.866-3.756 1.58-4.948.12-.197.237-.381.353-.552a6.507 6.507 0 0 0-4.666 5.5Zm10.181 1.5c-.144 2.074-.866 3.756-1.58 4.948-.12.197-.237.381-.353.552a6.507 6.507 0 0 0 4.666-5.5Zm2.733-1.5a6.507 6.507 0 0 0-4.666-5.5c.123.181.24.365.353.552.714 1.192 1.436 2.874 1.58 4.948Z"></path></svg>
</a>
<a class="md-social__link" href="https://www.instagram.com/cfc_uwa/" rel="noopener" target="_blank" title="www.instagram.com">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"></path></svg>
</a>
<a class="md-social__link" href="https://www.facebook.com/codersforcauses" rel="noopener" target="_blank" title="www.facebook.com">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M512 256C512 114.6 397.4 0 256 0S0 114.6 0 256c0 120 82.7 220.8 194.2 248.5V334.2h-52.8V256h52.8v-33.7c0-87.1 39.4-127.5 125-127.5 16.2 0 44.2 3.2 55.7 6.4V172c-6-.6-16.5-1-29.6-1-42 0-58.2 15.9-58.2 57.2V256h83.6l-14.4 78.2H287v175.9C413.8 494.8 512 386.9 512 256z"></path></svg>
</a>
<a class="md-social__link" href="https://www.youtube.com/channel/UCp47I0qUXeGgSK0AtFJSkbQ" rel="noopener" target="_blank" title="www.youtube.com">
<svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"></path></svg>
</a>
<a class="md-social__link" href="https://www.linkedin.com/company/coders-for-causes/" rel="noopener" target="_blank" title="www.linkedin.com">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg>
</a>
<a class="md-social__link" href="mailto:hello@codersforcauses.org" rel="noopener" target="_blank" title="">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M498.1 5.6c10.1 7 15.4 19.1 13.5 31.2l-64 416c-1.5 9.7-7.4 18.2-16 23s-18.9 5.4-28 1.6L284 427.7l-68.5 74.1c-8.9 9.7-22.9 12.9-35.2 8.1S160 493.2 160 480v-83.6c0-4 1.5-7.8 4.2-10.7l167.6-182.9c5.8-6.3 5.6-16-.4-22s-15.7-6.4-22-.7L106 360.8l-88.3-44.2C7.1 311.3.3 300.7 0 288.9s5.9-22.8 16.1-28.7l448-256c10.7-6.1 23.9-5.5 34 1.4z"></path></svg>
</a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.tabs", "toc.integrate", "header.autohide", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
<script src="../../assets/javascripts/bundle.dd8806f2.min.js"></script>
<script src="https://unpkg.com/mermaid@8.8.2/dist/mermaid.min.js"></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tablesort/5.2.1/tablesort.min.js"></script>
<script src="../../javascripts/tablesort.js"></script>
</body>
</html>